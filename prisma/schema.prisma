generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Each model is mapped to a table in our Postgres database - Neon

model User {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  imageUrl  String?
  firstName String?
  lastName  String?

  emailAddress String @unique
  credits      Int    @default(150) 
  
  // credits is like for how many credits we want to give them to use

  // one credit means one file that we helps us you to processed out - 150 credits is the free tier that we allows user to have when creating project

  userToProjects UserToProject[]
}

model Project {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  name      String
  githubUrl String

  deletedAt DateTime?

  userToProjects UserToProject[]
  commits        Commit[]
}

// Bridging Model for creating relationships between User To Project means A project have multiple users and A user can be a part of multiple projects - Many to Many relationship

model UserToProject {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  userId    String
  projectId String

  user User @relation(fields: [userId], references: [id])

  project Project @relation(fields: [projectId], references: [id])

  @@unique([userId, projectId]) // if we're a user we can only have a pairing of one unique userID , projectID : this the compound key that we are just creating
}

// model to store commits : a project have list of commits which is an array of commits

model Commit {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  projectId String
  project   Project @relation(fields: [projectId], references: [id])

  commitMessage      String
  commitHash         String
  commitAuthorName    String
  commitAuthorAvatar String
  commitDate         DateTime

  // ai summary
  summary String
}

model Test{
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  name      String
}